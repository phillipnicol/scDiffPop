"0","Tree <- matrix(nrow = 0, ncol = 2)

counter <- 1

for(i in 2:ncol(TreeMat)) {
  newvals <- unique(TreeMat[TreeMat[,i] > counter,i])
  for(j in newvals) {
    counter <- counter + 1 
    ixs <- which(TreeMat[,i] == counter)
    newvec <- c(counter, TreeMat[ixs[1], i-1])
    Tree <- rbind(Tree, newvec)
  }
}

#Change names of leaves
cntr <- 1
for(ct in TreeMat[,ncol(TreeMat)]) {
  ix <- which(Tree[,1] == ct)
  Tree[ix,1] <- cell_types[cntr]
  cntr <- cntr+1
}

# Also give the columns a name 
colnames(Tree) <- c(""Child"", ""Parent"")
rownames(Tree) <- c(1:nrow(Tree))
Tree 
"
"1","  "
"1"," Child          "
"1"," Parent"
"1","
1 "
"1"," ""2""            "
"1"," ""1""   "
"1","
2 "
"1"," ""3""            "
"1"," ""1""   "
"1","
3 "
"1"," ""4""            "
"1"," ""3""   "
"1","
4 "
"1"," ""5""            "
"1"," ""3""   "
"1","
5 "
"1"," ""6""            "
"1"," ""2""   "
"1","
6 "
"1"," ""7""            "
"1"," ""2""   "
"1","
7 "
"1"," ""8""            "
"1"," ""4""   "
"1","
8 "
"1"," ""Neutrophil""   "
"1"," ""4""   "
"1","
9 "
"1"," ""10""           "
"1"," ""7""   "
"1","
10"
"1"," ""11""           "
"1"," ""7""   "
"1","
11"
"1"," ""Fibroblast(?)"""
"1"," ""5""   "
"1","
12"
"1"," ""13""           "
"1"," ""5""   "
"1","
13"
"1"," ""14""           "
"1"," ""8""   "
"1","
14"
"1"," ""pDC(?)""       "
"1"," ""8""   "
"1","
15"
"1"," ""CD8 Eff. T""   "
"1"," ""10""  "
"1","
16"
"1"," ""NK Cell""      "
"1"," ""10""  "
"1","
17"
"1"," ""CD8 T""        "
"1"," ""11""  "
"1","
18"
"1"," ""CRYAB+(?)""    "
"1"," ""11""  "
"1","
19"
"1"," ""B""            "
"1"," ""6""   "
"1","
20"
"1"," ""Plasma B""     "
"1"," ""6""   "
"1","
21"
"1"," ""Macrophage""   "
"1"," ""13""  "
"1","
22"
"1"," ""Monocytes""    "
"1"," ""13""  "
"1","
23"
"1"," ""Dendritic""    "
"1"," ""14""  "
"1","
24"
"1"," ""Basophil""     "
"1"," ""14""  "
"1","
"
